### **12.2 â€“ `Promise`, `then`, `catch`, `finally`**

**ğŸ”¹ Promise Nedir?**

JavaScript'te bir iÅŸlem **hemen sonuÃ§lanmayacaksa**, Ã¶rneÄŸin bir API'den veri Ã§ekiliyorsa, bunu **Promise** ile temsil ederiz.

> Promise: Gelecekte bir deÄŸeri temsil eden, henÃ¼z hazÄ±r olmayan bir nesnedir.
> 

---

**ğŸ“Œ Promise 3 duruma sahip olabilir:**

1. **Pending (beklemede):** HenÃ¼z tamamlanmadÄ±.
2. **Fulfilled (baÅŸarÄ±lÄ±):** `resolve` Ã§aÄŸrÄ±ldÄ±.
3. **Rejected (hata):** `reject` Ã§aÄŸrÄ±ldÄ±.

---

**ğŸ”¹ Temel Promise YapÄ±sÄ±**

```jsx
const benimPromisim = new Promise((resolve, reject) => {
  const basariliMi = true;

  if (basariliMi) {
    resolve("Ä°ÅŸlem baÅŸarÄ±lÄ±!");
  } else {
    reject("Bir hata oluÅŸtu!");
  }
});
```

âœ… **Kod AkÄ±ÅŸÄ± (sÃ¶zel olarak):**

1. `benimPromisim` adÄ±nda bir **Promise** oluÅŸturuluyor.
2. `new Promise(...)` iÃ§ine bir **arrow function** veriliyor.
3. Bu arrow function, JavaScript tarafÄ±ndan otomatik saÄŸlanan iki Ã¶zel parametre alÄ±yor:
    
    `resolve` ve `reject`.
    
    Bunlar sadece **Promise yapÄ±sÄ±na Ã¶zgÃ¼dÃ¼r**, yani `new Promise(...)` yapÄ±sÄ±nda otomatik tanÄ±mlanÄ±rlar.
    
    - `resolve`: iÅŸlemi **baÅŸarÄ±lÄ±** ÅŸekilde tamamlamak iÃ§in kullanÄ±lÄ±r.
    - `reject`: iÅŸlemi **hatalÄ±** ÅŸekilde sonlandÄ±rmak iÃ§in kullanÄ±lÄ±r.
4. `basariliMi` adÄ±nda bir deÄŸiÅŸken tanÄ±mlanmÄ±ÅŸ ve `true` yapÄ±lmÄ±ÅŸ.
5. EÄŸer `basariliMi` true ise:
    - `resolve("Ä°ÅŸlem baÅŸarÄ±lÄ±!")` Ã§aÄŸrÄ±lÄ±r â†’ **Promise baÅŸarÄ±lÄ± olur.**
6. EÄŸer false olsaydÄ±:
    - `reject("Bir hata oluÅŸtu!")` Ã§aÄŸrÄ±lÄ±rdÄ± â†’ **Promise baÅŸarÄ±sÄ±z olurdu.**
    

Bir Promiseâ€™in **baÅŸarÄ±lÄ±** (`resolve`) veya **baÅŸarÄ±sÄ±z** (`reject`) olmasÄ± genelde:

- **Bir API Ã§aÄŸrÄ±sÄ± yaparsan**, Ã¶rneÄŸin veri Ã§ekme:
    - EÄŸer veri **baÅŸarÄ±yla gelirse** â†’ `resolve(veri)`
    - EÄŸer bir **hata olursa** (Ã¶rneÄŸin baÄŸlantÄ± hatasÄ±, 404, vs.) â†’ `reject(hata)`

---

**ğŸ”¹ `then`, `catch`, `finally` ile kullanÄ±m**

`then`, `catch`, ve `finally` yapÄ±larÄ± JavaScriptâ€™te `Promise` nesneleriyle birlikte kullanÄ±lÄ±r. AmaÃ§larÄ± ÅŸÃ¶yledir:

- **`then()`**: Ä°ÅŸlem baÅŸarÄ±lÄ±ysa yapÄ±lacak ÅŸeyi tanÄ±mlar. Yani `resolve()` Ã§alÄ±ÅŸÄ±rsa, bu blok devreye girer.
- **`catch()`**: Ä°ÅŸlem baÅŸarÄ±sÄ±z olursa (yani `reject()` Ã§alÄ±ÅŸÄ±rsa) hatayÄ± yakalayÄ±p iÅŸleyecek kod buraya yazÄ±lÄ±r.
- **`finally()`**: Ä°ÅŸlem baÅŸarÄ±lÄ± veya baÅŸarÄ±sÄ±z olsa bile **her durumda** Ã§alÄ±ÅŸacak kodlar buraya yazÄ±lÄ±r. Genelde temizleme (cleanup) iÅŸleri iÃ§in kullanÄ±lÄ±r.

Bu yapÄ± sayesinde asenkron iÅŸlemler sonrasÄ± ne yapÄ±lacaÄŸÄ±nÄ± dÃ¼zenli bir ÅŸekilde yazabiliriz.

Kodumuz tam olarak bu ÅŸekilde:

```jsx
const benimPromisim = new Promise((resolve, reject) => {
  const basariliMi = true;

  if (basariliMi) {
    resolve("Ä°ÅŸlem baÅŸarÄ±lÄ±!");
  } else {
    reject("Bir hata oluÅŸtu!");
  }
});

benimPromisim
  .then((sonuc) => {
    console.log("BaÅŸarÄ±lÄ±:", sonuc);
  })
  .catch((hata) => {
    console.log("Hata:", hata);
  })
  .finally(() => {
    console.log("Ä°ÅŸlem tamamlandÄ±.");
  });

//basariliMi deÄŸiÅŸkeni true olduÄŸu iÃ§in Ã§Ä±ktÄ± ÅŸÃ¶yle olur:

//Ã‡Ä±ktÄ±:
//BaÅŸarÄ±lÄ±: Ä°ÅŸlem baÅŸarÄ±lÄ±!
//Ä°ÅŸlem tamamlandÄ±.
```

âœ… **Kod AkÄ±ÅŸÄ± (sÃ¶zel olarak):**

1. `benimPromisim` adÄ±nda bir **Promise** oluÅŸturuluyor.
2. `new Promise((resolve, reject) => { ... })` ifadesinde iki Ã¶zel fonksiyon parametre olarak alÄ±nÄ±yor:
    - `resolve`: iÅŸlemi baÅŸarÄ±yla tamamlamak iÃ§in Ã§aÄŸrÄ±lÄ±r.
    - `reject`: iÅŸlemde hata varsa Ã§aÄŸrÄ±lÄ±r.
3. Ä°Ã§eride `basariliMi` deÄŸiÅŸkeni `true` olarak ayarlanmÄ±ÅŸ.
    - Yani `if` bloÄŸu Ã§alÄ±ÅŸÄ±r ve `resolve("Ä°ÅŸlem baÅŸarÄ±lÄ±!")` Ã§aÄŸrÄ±lÄ±r.
    - Promise, **baÅŸarÄ±lÄ±** ÅŸekilde sonuÃ§lanÄ±r.
4. `benimPromisim` Ã¼zerinde `.then(...)` kullanÄ±lÄ±r:
    - EÄŸer `resolve` Ã§alÄ±ÅŸmÄ±ÅŸsa (baÅŸarÄ± varsa) burasÄ± Ã§alÄ±ÅŸÄ±r.
    - `sonuc` deÄŸiÅŸkeni, `resolve` ile verilen deÄŸeri alÄ±r.
    - `console.log("BaÅŸarÄ±lÄ±:", sonuc);` Ã§Ä±ktÄ±sÄ± verilir.
5.  `.catch(...)` bloÄŸu:
    - EÄŸer `reject` Ã§alÄ±ÅŸsaydÄ± (hata olsaydÄ±), bu blok Ã§alÄ±ÅŸacaktÄ±.
    - `hata` deÄŸiÅŸkeni, `reject` ile gÃ¶nderilen mesajÄ± alÄ±r.
6. `.finally(...)` bloÄŸu:
    - Hangi durumda olursa olsun (baÅŸarÄ± da olsa, hata da olsa) **her zaman Ã§alÄ±ÅŸÄ±r**.
    - Genellikle temizleme iÅŸlemleri, yÃ¼klemeyi kapatma gibi ÅŸeyler iÃ§in kullanÄ±lÄ±r.
    - Burada `console.log("Ä°ÅŸlem tamamlandÄ±.")` Ã§alÄ±ÅŸÄ±r.

---

**ğŸ§  KÄ±sa Ã¶zet:**

| YapÄ± | Ne zaman Ã§alÄ±ÅŸÄ±r? | Ne yapar? |
| --- | --- | --- |
| `.then()` | Ä°ÅŸlem baÅŸarÄ±lÄ±ysa | Veriyi alÄ±r ve iÅŸler |
| `.catch()` | Hata olursa | Hata mesajÄ±nÄ± yakalar |
| `.finally()` | Her durumda (baÅŸarÄ±/hata) | Temizlik veya son iÅŸlem yapÄ±lÄ±r |

---

**Ã–rnek:**
AÅŸaÄŸÄ±da Ã¶rnek Promise yapÄ±sÄ±yla, **SalÄ± gÃ¼nkÃ¼ randevularÄ± getiren** bir senaryo oluÅŸturdum:

```jsx
const saliRandevulariniGetir = new Promise((resolve, reject) => {
  const basariliMi = true;

  const randevular = [
    { isim: "Ali", gun: "SalÄ±" },
    { isim: "AyÅŸe", gun: "Pazartesi" },
    { isim: "Mehmet", gun: "SalÄ±" },
  ];

  if (basariliMi) {
    const saliRandevulari = randevular.filter(r => r.gun === "SalÄ±");
    resolve(saliRandevulari);
  } else {
    reject("VeritabanÄ±na ulaÅŸÄ±lamadÄ±!");
  }
});

saliRandevulariniGetir
  .then((veri) => {
    console.log("SalÄ± randevularÄ±:", veri);
  })
  .catch((hata) => {
    console.log("Hata:", hata);
  })
  .finally(() => {
    console.log("Randevu Ã§ekme iÅŸlemi tamamlandÄ±.");
  });
```

```
Ã‡Ä±ktÄ±:
SalÄ± randevularÄ±: [ { isim: "Ali", gun: "SalÄ±" }, { isim: "Mehmet", gun: "SalÄ±" } ]
Randevu Ã§ekme iÅŸlemi tamamlandÄ±.
```

---
